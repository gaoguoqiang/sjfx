<!doctype html>
<html>
<head>
    <link rel="alternate" media="only screen and (max-width: 640px)" href="http://m.ceshi.codes99.com/news_tech/2465.html" >
    <meta charset="gb2312" />
    <meta http-equiv="Content-Type" content="text/html; charset=gb2312">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, minimal-ui">
    
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    
<script src="http://siteapp.baidu.com/static/webappservice/uaredirect.js" type="text/javascript"></script><script type="text/javascript">uaredirect("http://m.ceshi.codes99.com/news_tech/2465.html");</script>
    
    <title>小马已变坏，“小马激活”病毒分析，你在用小马激活吗？小心了 - 今日头条(ceshi.codes99.com)</title>
    <meta name="keywords" content="科技,网络安全,软件,浏览器">
	<meta name="description" content="小马已变坏，“小马激活”病毒分析，你在用小马激活吗？小心了">

    <link type="text/css" rel="stylesheet" href="/style/ndetail_65199b6.css">
    <link type="text/css" rel="stylesheet" href="/style/nbase_b0dd754.css">
    <link type="text/css" rel="stylesheet" href="/style/core_e4b8984.css">
    
	<script type="text/javascript" charset="gb2312" src="/style/lib_538033e.js"></script>
	<script type="text/javascript" charset="gb2312" src="/style/qrcode.min_1dc0697.js"></script>
	<script type="text/javascript" charset="gb2312" src="/style/asyncmap_2c7ae8b.js"></script>
</head>
<body class="v2016">
    
    
  <div id="wrapper" class="detail-wrapper">
    <div id="pagelet-nnav" class="nohome">
	<!-- 滚动条效果 -->
	<div id="instantclick">
		<div id="instantclick-bar" class="instantclick-bar">
		</div>
	</div>
	<div class="topbarWrapper" class="clearfix">
		
		<ul class="left topNav">
									<li class="tb-item"><a class="tb-link" href="/news_hot/" target="_blank" ga_event="">热点</a></li>
									<li class="tb-item"><a class="tb-link" href="/news_society/" target="_blank" ga_event="">社会</a></li>
									<li class="tb-item"><a class="tb-link" href="/news_entertainment/" target="_blank" ga_event="">娱乐</a></li>
									<li class="tb-item"><a class="tb-link" href="/news_tech/" target="_blank" ga_event="">科技</a></li>
									<li class="tb-item"><a class="tb-link" href="/news_car/" target="_blank" ga_event="">汽车</a></li>
									<li class="tb-item"><a class="tb-link" href="/news_sports/" target="_blank" ga_event="">体育</a></li>
									<li class="tb-item"><a class="tb-link" href="/news_finance/" target="_blank" ga_event="">财经</a></li>
									<li class="tb-item"><a class="tb-link" href="/news_military/" target="_blank" ga_event="">军事</a></li>
									<li class="tb-item"><a class="tb-link" href="/news_world/" target="_blank" ga_event="">国际</a></li>
									<li class="tb-item"><a class="tb-link" href="/news_fashion/" target="_blank" ga_event="">时尚</a></li>
									<li class="tb-item"><a class="tb-link" href="/news_travel/" target="_blank" ga_event="">旅游</a></li>
									<li class="tb-item"><a class="tb-link" href="/news_discovery/" target="_blank" ga_event="">探索</a></li>
						<li class="tb-item" data-node="moreNav" id="moreNav">
				<a class="tb-link moreNav" href="javascript:;" ga_event="">更多</a>
				<div class="nav-layer">
					<ul>
	                    							                    <li><a href="/news_baby/" class="layer-item" ga_event="">育儿</a></li>
													                    <li><a href="/news_regimen/" class="layer-item" ga_event="">养生</a></li>
													                    <li><a href="/news_story/" class="layer-item" ga_event="">故事</a></li>
													                    <li><a href="/news_essay/" class="layer-item" ga_event="">美文</a></li>
													                    <li><a href="/news_game/" class="layer-item" ga_event="">游戏</a></li>
													                    <li><a href="/news_history/" class="layer-item" ga_event="">历史</a></li>
													                    <li><a href="/news_food/" class="layer-item" ga_event="">美食</a></li>
											</ul>
				</div>
			</li>
		</ul>
	<!--反馈 start-->
<script>
$(function(){
	$('.feedbtn').click(function(){$('.feedback_dialog').toggleClass('on')});
	$('.feedback_dialog .close').click(function(){$('.feedback_dialog').removeClass('on')})
});
function submitfeedback(obj){
  var name='匿名';
var email=$('[name=email]').val();
var lytext=$('[name=lytext]').val();
if(!email){alert('请填写联系方式');return false;}
if(!lytext){alert('您的意见');return false;}

}
</script>
<div class="dialog feedback_dialog">
    <div class="dialog-header">
        <h3>意见反馈</h3>
    </div>
    <div class="dialog-inner" data-node="inner">
        <div class="feedback_panel">
            <form action="/e/enews/index.php" method="post" name="form1" onsubmit="return submitfeedback(this)">
                <ul>
                    <li>
                        <p class="label">联系方式（必填）</p>
                        <div class="input-group">
                            <input class="email" placeholder="您的邮箱" type="text" name="email">
                        </div>
                    </li>
                    <li>
                        <p class="label">您的意见（必填）</p>
                        <div class="input-group">
                            <textarea style="height:100px;" name="lytext" class="content" maxlength="140" placeholder="请填写您的意见，不超过140字"></textarea>
                        </div>
                    </li>
                    <li>
                        <div class="input-group">
                               <input name="name" type="hidden" id="name" value="匿名">
                            <input type="submit" name="Submit3" class="submit-btn" value="提交">
                                <input name="enews" type="hidden" id="enews" value="AddGbook" />
                                <input type="hidden" name="ecmsfrom" value="/">
                            <span class="msg" data-node="msg"></span>
                            <a data-node="close" class="close" href="javascript:;">[关闭]</a>
                        </div>
                    </li>
                </ul>
            </form>
        </div>
    </div>
</div>
<!--反馈 end-->


		<ul class="right">
                         <li class="tb-item"><span><script src="/e/member/login/loginjs2.php"></script></span></li>
			<li class="tb-item" id="mth"><a class="tb-link" href="/e/member/login" target="_blank">媒体号</a></li>
			
			<li class="tb-item"><a class="tb-link feedbtn" href="javascript:;" >反馈</a></li>
			<li class="tb-item" data-node="more" id="moreAbout">
				<a class="tb-link" href="/about/" ga_event="nav_more">更多</a>
				<div class="layer">
					<ul>
						<li><a href="/about/about.html" class="layer-item">关于我们</a></li>
						<li><a href="/about/join.html" class="layer-item">加入头条</a></li>
						<li><a href="/about/report.html" class="layer-item">媒体报道</a></li>
						<li><a href="/about/media_partners.html" class="layer-item">媒体合作</a></li>
						<li><a href="/about/cooperation.html" class="layer-item">产品合作</a></li>
						<li><a href="/about/media_cooperation.html" class="layer-item">合作说明</a></li>
						<li><a href="/about/contact.html" class="layer-item">联系我们</a></li>
						<li><a href="/about/user_agreement.html" class="layer-item">用户协议</a></li>
						<li><a href="/about/complain.html" class="layer-item">投诉指引</a></li>
					</ul>
				</div>
			</li>
		</ul>
	</div>

	<!--[if lt IE 9 ]><style>.midbarWrapper{border-bottom:1px solid #e8e8e8;}</style><![endif]-->
	<div class="midbarWrapper">
		<div class="midbar-inner">
			<div class="logo-box">
				<a class="logo-link" href="/" ga_event="nav_icon"><img class="logo" src="/style/logo.png"></a>
			</div>
			<div class="search-box" data-node="searchBox">
				<form action="/e/search/" method="get" data-node="searchForm" target="_blank">
	                <div class="input-group clearfix">
										<!-- <span class="placeholder" data-node="placeholder"></span> -->
	                    <input autocomplete="off" ga_event="nav_search_input" data-node="searchInput" name="keyword" type="text" placeholder="" value="">
	                    <div class="btn-submit">
	                        <button ga_event="nav_search" type="submit" href="javascript:;" data-node="searchSubmit">
	                            <i class="icon icon-search"></i>
	                        </button>
	                    </div>
	                </div>
	            </form>
	            <div class="slayer">
	            	<div class="slayer-con">
	            		<div class="search-tip">热门搜索</div>
                    	<ul data-node="searchMenu"></ul>
                    </div>
                </div>
			</div>
			<div class="user-box" data-node="userbox" >
				
			</div>
		</div>
	</div>
</div>

    <div id="container" class="clearfix">
      <div class="detail-main">
        <div id="pagelet-article">
	
	<div class="curpos">
		<a href="/" target="_blank" ga_event="click_index">首页</a>
		&gt;
		<a href="#" target="_blank" ga_event="click_channel">科技</a>
	</div>
	
	<div class="article-header">
		<h1 class="title">小马已变坏，“小马激活”病毒分析，你在用小马激活吗？小心了</h1>
		<div class="minibar clearfix">
			
            
            <span class="time">2016-04-20 20:12</span>
		</div>
	</div>
	<div class="article-content"><p><img src="http://p2.pstatp.com/large/5010000053f935c5f90?123.jpg"/></p><p>一、概述</p><p> 随着安全软件与病毒之间攻防对抗的不断白热化，病毒的更新换代也日益频繁，其所使用的手段也日趋多样化。以最近大范围流行的“小马激活”病毒为例，其传播至今，据火绒发现的样本中已经演变出了五个变种。“小马激活”病毒，我们之前称其为“苏拉克”病毒，因为其核心驱动名为“surak.sys”故得此名，但是随着其不断地改变与安全软件的对抗方式，“苏拉克”这个名字已经不被病毒作者使用，所以我们将其统称为“小马激活”病毒。</p><p> “小马激活”病毒的第一变种只是单纯地在浏览器快捷方式后面添加网址参数和修改浏览器首页的注册表项，以达到首页劫持的目的。由于安全软件的查杀和首页保护功能，该版本并没有长时间流行太长时间。其第二变种，在原有基础上增强了与安全软件的对抗能力。由于其作为“系统激活工具”具有入场时间较早的优势，使用驱动与安全软件进行主动对抗，使安全软件无法正常运行。在其第三个变种中，其加入了文件保护和注册表保护，不但增加了病毒受害者自救的难度，还使得反病毒工程师在处理用户现场时无法在短时间之内发现病毒文件和病毒相关的注册表项。其第四个变种中，利用WMI中的永久事件消费者（ActiveScriptEventConsumer）注册恶意脚本，利用定时器触发事件每隔一段时间就会执行一段VBS脚本，该脚本执行之后会在浏览器快捷方式后面添加网址参数。该变种在感染计算机后，不会在计算机中产生任何文件，使得病毒分析人员很难发现病毒行为的来源，大大增加了病毒的查杀难度。通过如下表格我们可以更直观的了解其发展过程：</p><table class="border"><tbody><tr class="firstRow"><td></td><td>主要传播时间</td><td>病毒行为</td><td>对抗方式</td></tr><tr><td>第一代</td><td>2015年9月至2015年12月</td><td>・ 流量劫持：1) 修改浏览器快捷方式</td><td>・ 无</td></tr><tr><td>第二代</td><td>2015年12月至2016年2月</td><td>・ 进程入侵1) 将病毒动态库注入explorer.exe进程・ 流量劫持1) 修改浏览器快捷方式2) 通过驱动劫持首页</td><td>・ 禁止安全软件加载驱动</td></tr><tr><td>第三代</td><td>2016年2月至2016年3月</td><td>・ 进程入侵1) 将病毒动态库注入explorer.exe进程・ 流量劫持1) 修改浏览器快捷方式2) 通过驱动劫持首页</td><td>・ 禁止安全软件加载驱动・ 随机驱动名・ 文件保护・ 注册表保护</td></tr><tr><td>第四代</td><td>2016年3月至2016年4月</td><td>・ 流量劫持：1) 利用WMI脚本，定时修改浏览器快捷方式</td><td>・ 病毒行为在WMI脚本进行，本地无其病毒文件</td></tr><tr><td>第五代</td><td>2016年4月至今</td><td>・ 进程入侵1) 将病毒动态库注入explorer.exe进程・ 流量劫持1) 修改浏览器快捷方式2) 通过注入explorer.exe中的动态库劫持浏览器首页3) 修改注册表锁定浏览器首页</td><td>・ 每次重启后重新生成随机驱动名・ 文件保护・ 注册表保护</td></tr></tbody></table><p>表1、“小马激活”病毒发展过程</p><p> 通过我们近期接到的用户反馈，我们发现了“小马激活”病毒的新变种。该变种所运用的对抗技术十分复杂，进一步增加了安全软件对其有效处理的难度，甚至使得病毒分析人员通过远程协助处理用户现场变得更困难。这个“小马激活”病毒的最新变种运行界面如下：</p><p><img src="http://p1.pstatp.com/large/485000a8384b3e0eb7c?123.jpg"/></p><p>图1、 “小马激活”新变种运行界面</p><p>二、样本分析</p><p> 该病毒释放的驱动文件通过VMProtect加壳，并通过过滤驱动的方式拦截文件系统操作（图2），其目的是保护其释放的动态库文件无法被删除。通过文件系统过滤驱动，使得系统中的其他进程在打开该驱动文件句柄时获得却是tcpip.sys文件的句柄，如果强行删除该驱动文件则会变为删除tcpip.sys文件，造成系统无法正常连接网络。我们通过下图可以看到火绒剑在查看文件信息时，读取的其实是tcpip.sys文件的文件信息。由于此功能，使得病毒分析人员无法在系统中正常获取该驱动的样本。</p><p><img src="http://p3.pstatp.com/large/483000a4606a8a05222?123.jpg"/></p><p>图2、文件驱动钩子和关机通知</p><p> 该驱动通过注册关机回调（图2）在系统关机时该驱动会将自身在%SystemRoot%\System32\Drivers目录重新拷贝成随机名字的新驱动文件，并将驱动信息写入注册表，以便于下一次时启动加载。在驱动加载之后，其会将locc.dll注入到explorer.exe进程中。该驱动对locc.dll文件也进行了保护，当试图修改或者删除该动态库时，会弹出错误提示“文件过大”。如图3所示：</p><p><img src="http://p1.pstatp.com/large/483000a4607d6b57de8?123.jpg"/></p><p>图3、文件驱动钩子和关机通知</p><p> 当病毒的驱动将locc.dll注入到explorer.exe进程后会执行首页劫持相关逻辑。通过火绒剑的内存转储，我们可以看到该病毒锁定的所有网址。</p><p><img src="http://p3.pstatp.com/large/486000a3a61baeea9d9?123.jpg"/></p><p> 通过抓取上述网址中的网页信息（图4），我们可以发现上述网址中存放的其实是一个跳转页。通过使用跳转页面，病毒作者可以灵活调整计费链接和推广网址，并且对来自不同浏览器的流量进行分类统计。</p><p><img src="http://p1.pstatp.com/large/484000a7a7d2205c238?123.jpg"/></p><p>图4、网页内容</p><p>三、信息追踪</p><p> 通过测试我们现有的最新该病毒样本，我们发现该病毒不但推广了国内的一些导航站和电商门户网站（图5），还推广了仿冒的小马激活网站（www.xiaomajihuo.net）用来进一步传播病毒。其推广网址如下：</p><p><img src="http://p3.pstatp.com/large/485000a83b4d6bbfe25?123.jpg"/></p><p><img src="http://p1.pstatp.com/large/486000a3a2ec56a2683?123.jpg"/></p><p>图5、病毒推广效果图</p><p> 仿冒的小马激活网站访问效果如下：</p><p><img src="http://p3.pstatp.com/large/483000a460839d82108?123.jpg"/></p><p>图6、网址访问效果图</p><p> 病毒下载地址为百度云盘下载链接，如下图所示：</p><p><img src="http://p2.pstatp.com/large/487000a85c033083103?123.jpg"/></p><p>图7、百度云盘链接访问效果图</p><p>通过反查仿冒的“小马激活”官网（xiaomajihuo.net）域名，我们找到了其域名注册时使用的邮箱[url=mailto:―vo******o@enamewhois.com]―vo******o@enamewhois.com[/url]。通过该邮箱，我们找到了所有使用该邮箱注册的域名信息。如下图所示：</p><p><img src="http://p3.pstatp.com/large/483000a460944e9420c?123.jpg"/></p><p>图8、使用vo******o@enamewhois.com邮箱注册的域名关系图</p><p> 通过访问上述关系图中的域名，我们发现：</p><ul class=" list-paddingleft-2"><li><p>该“病毒推广公司”利用“小马激活”病毒进行推广，利用多个仿冒小马激活官网在互联网中进行传播。</p></li><li><p>6位数字加“.com”结尾的域名（下文称数字域名）中用来架设其首页劫持要用到的跳转页面。</p></li></ul><p> 由于我们通过“xiaomajihuo.net”域名可以获取的信息比较有限，我们对关系网中（上图所示）的“xiaomajihuo.cn”域名进行了反查。我们发现有超过50个域名指向这一IP地址，如下图所示：</p><p><img src="http://p3.pstatp.com/large/483000a460a84db3997?123.jpg"/></p><p>图9、同一IP下的域名列表</p><p> 观察这些域名，很容易发现有多个域名带有“xiaomajihuo”的字样。在这些域名中，还有很多XM开头的域名，我们猜测其本意应为“小马”的拼音缩写。在对其关联网址进行访问时我们发现：</p><p> 带有“xiaomajihuo”字样的网址全部都是仿冒的“小马激活”官网，其网页样式与前文提到的“www.xiaomajihuo.net”样式相同。</p><p> XM开头的所有网址都为该病毒的下载页面，其网页样式模仿了当前的主流下载站，具有很强的迷惑性（图10）。</p><p><img src="http://p3.pstatp.com/large/484000a7a7e7cddc768?123.jpg"/></p><p>图10、网页访问效果图</p><p> 在网址www.ydjph.com和www.yrdqm.com中，我们发现虽然页面样式相同，下载文件名为“win7 activation v1.8”，根据我们的分析，该样本也同为该病毒，其下载地址也为百度云盘链接，链接地址为“pan.baidu.com/s/1o79KKII”。</p><p>在域名列表中的其他域名，虽然看上去名字随机性很强，但是我们通过访问其页面后发现如下网址为该“病毒生产厂商”的业务推广站：</p><p><img src="http://p3.pstatp.com/large/487000a85f56e174e9e?123.jpg"/></p><p> 就在正在完成这份文档的同时，最后两个域名内容已经变为了类似图10的病毒下载页面。</p><p> 根据工商局企业查询系统和搜索引擎的查询结果，上述网址中出现的公司经营范围均为传统行业，且均有正规官网。所以上述网址中出现的公司名为盗用（图11），用来扰乱人们视线。其公司服务项目中涵盖了广告推广、网页制作、软件开发和技术支持（图12），这与“小马激活”病毒的首页劫持推广功能相吻合，即该病毒就是该“病毒推广公司”的广告推广工具之一。如下图所示：</p><p><img src="http://p1.pstatp.com/large/486000a3a2fb2b037e4?123.jpg"/></p><p>图11、其盗用的公司名</p><p><img src="http://p3.pstatp.com/large/484000a7a7fc9043c8d?123.jpg"/></p><p>图12、“病毒推广公司”的业务推广站</p><p> 在同一IP下还有两个软件推广网址，分别推广QQ浏览器（图13）和2345浏览器（图14），其推广域名如下。</p><p><img src="http://p1.pstatp.com/large/483000a4665e3763977?123.jpg"/></p><p> 软件推广网址如下图所示：</p><p><img src="http://p3.pstatp.com/large/483000a460ca744618a?123.jpg"/></p><p>图13、该IP下的QQ浏览器推广网址</p><p><img src="http://p3.pstatp.com/large/486000a3a31dd9296be?123.jpg"/></p><p>图14、该IP下的QQ浏览器推广网址</p><p> 我们进一步查询了“xiaomajihuo.com.cn”域名信息的相互联系（图15），我们不难发现与该域名相关的大部分仿冒的小马激活网站都是使用[url=mailto:“as*****0@qq.com]“as*****0@qq.com[/url]”这个QQ邮箱进行注册。通过对其QQ邮箱的查询，我们定位到了该病毒作者的QQ号码为133*****7，名叫“叶*”。</p><p><img src="http://p3.pstatp.com/large/50100000493bdefc797?123.jpg"/></p><p>图15、xiaomajihuo.com.cn域名信息联系图</p><p> 样本在执行过程中还访问了网址“tongji.227237.com”,通过访问该网址我们了解到在该域名所在服务器中架设着一套“推广流量监控系统”（图16），所有其推广的流量都会先经过该站，以用于其查看推广效果。</p><p><img src="http://p2.pstatp.com/large/487000a85c1cdc67e9e?123.jpg"/></p><p>图16、该病毒的流量统计系统</p><p> 根据这些线索，我们理清了该“恶意推广”业务的主要流程。其首先制作系统激活工具作为其“恶意推广工具”，之后再通过百度推广等推广方式进行大范围扩散，在用户运行这些程序之后，将用户首页劫持为数字域名，在该域名下的网页中加入跳转网址和付费链接，最终以推广互联网公司的产品或主页进行谋利。</p><p> 为了躲避安全软件的网址拦截，其申请的数字域名变动非常频繁，大部分数字域名已经无法访问，现在依然可以存活的跳转站除了上文中提到的“227237.com”还有“827837.com”和“107117.com”，他们分别是“爱淘宝”和“搜狗网址导航”的推广链接，如下图所示：</p><p><img src="http://p3.pstatp.com/large/483000a460b2e6f816f?123.jpg"/></p><p>图17、827837.com下跳转页内容</p><p><img src="http://p1.pstatp.com/large/487000a85c27d3292b4?123.jpg"/></p><p>图18、827837.com推广“爱淘宝”效果图</p><p><img src="http://p2.pstatp.com/large/484000a7a800b5fad57?123.jpg"/></p><p>图19、107117.com下跳转页内容</p><p><img src="http://p1.pstatp.com/large/485000a83859e9b381c?123.jpg"/></p><p>图20、107117.com推广“搜狗网址导航”效果图</p><p> 通过上述信息，我们可以清楚看到，绝大部分推广的网址都来自于国内的大型互联网企业，阿里巴巴、京东商城这种超大型网络公司甚至也在其中之列。由于当今国内互联网企业之间的竞争日益激烈，国内的大型互联网公司为了推广自己的产品更是可以“豪掷千金”，这一现象极大地刺激了“广告推广公司”的迅速壮大，其推广手段也不断翻新，更有甚者制作病毒进行广告推广，使得国内的互联网大环境中广告类病毒（Adware）的种类与传播范围在短时间之内迅速增加。普通用户在使用计算机时只要 “稍有疏忽”就会被捆绑上许多自己本不需要的应用，或者是首页被随意修改、浏览网页时被加上广告。广大用户深受其害，但是某些软件厂商不但没有加大推广商的审查力度，反而为了提高推广“成功率”提高了其软件的 “卸载难度”，使用户更加苦不堪言。我们从而可以得出结论，广告推广商与“病毒生产厂商”之间存在很大的交集， 这些“病毒推广公司”的推广业务主要服务于国内的主流互联网企业并不断地从中谋取暴利。利用这种盈利模式，“病毒推广公司”可以不断推动其黑色链条的运转，对互联网行业的健康发展造成十分恶劣的影响。</p><p>最后，我们在工信部的《ICP/IP地址/域名信息备案管理系统》上找到了与“vo******o@enamewhois.com”邮箱相关网站的ICP备案信息，我们以域名备案时间为主轴，梳理出了其“病毒推广公司”的主要成员信息及关键运营过程。</p><p>2015年7月13日，葛**首先备案了网站域名“301311.com”和上文中提到的“爱淘宝”推广网址“827837.com” （图21）。“301311.com”域名的“go”目录下存放着众多被推广的网址跳转页。这与该类型第一个变种出现的时间基本吻合。</p><p><img src="http://p2.pstatp.com/large/486000a3a300270d019?123.jpg"/></p><p>图21、葛**备案的网站信息</p><p> 2015年9月21日，殷**备案了网站域名“ujisu.com”和“231238.com”（图22）。前者为“U盘极速启动”官网，该工具可用于制作U盘启动盘。火绒希望广大用户在使用操作系统或者软件时可以支持正版，谨慎对待此类工具。与后者同时备案的同一类型域名还有很多，但都已无法访问。</p><p><img src="http://p3.pstatp.com/large/50100000494d4c1ac7c?123.jpg"/></p><p>图22、殷**备案的网站信息</p><p> 2015年12月9日，杨**使用“上海******有限公司”的公司名备案了域名“xiaomajihuo.com”和“227237.com”（图23）。前者为仿冒的小马激活官网，该网址现在已无法访问，后者域名架设着其 “推广流量监控系统”，所以初步推断其可能为该“病毒推广公司”的主要成员。</p><p><img src="http://p3.pstatp.com/large/486000a3a326562b6ba?123.jpg"/></p><p>图23、杨**备案的网站信息</p><p> 由于2016年初，国内很多安全厂商对“小马激活”进行了全面查杀，其域名也被很多安全软件拦截。所以在2016年1月13日至20日，张**、叶*、陈*等人备案了如下五个域名用于架设仿冒的小马激活官网（图24）。其域名开放时间有很强的随机性，所以当安全厂商认为其域名已经废弃，并将拦截记录“优化”掉的时候，其域名很有可能会再次“复活”。</p><p>xiaomajihuo.cn</p><p>xiaomajihuo.net</p><p>xiaomajihuo.com.cn</p><p>xiaomajihuo.org</p><p>xiaomajihuo.org.cn</p><p><img src="http://p1.pstatp.com/large/483000a460db2c279e9?123.jpg"/></p><p>图24、2016年1月13日至20日注册的假小马激活域名</p><p> 2016年3月20日，杨**在有关部门备案了域名“wanmeijihuo.com”（图25）。至今为止，该域名并未启用，但根据备案时间我们初步推断，该域名很有可能为其下一“恶意推广产品”的主要传播渠道。针对该情况，火绒已经针对其域名进行了提前拦截。</p><p><img src="http://p3.pstatp.com/large/501000004952914bb88?123.jpg"/></p><p>图25、“wangmeijihuo.com”域名备案信息</p><p> 为彻底查明事实真相，我们浏览了小马激活所谓的官方网站（www.pccppc.com），当进入其官网时页面最上方弹出了其“严正声明”，在其小马激活的下载专区我们发现其停止更新的公告。页面中还给出了其官方QQ群号，提示信息中写着“小马工具箱V1.01版已经发布”字样。如下图：</p><p><img src="http://p1.pstatp.com/large/485000a8386d3ac9204?123.jpg"/></p><p>图26、“小马激活官网”访问效果图</p><p> 我们尝试加入该群，我们发现其群共享文件中并没有其所谓的“小马工具箱”，而是有两个最近一个月左右上传的“小马激活工具”，其文件上传者就是其QQ群的创建者（图27-28），也就是其所谓“小马官方人士”上传。</p><p><img src="http://p3.pstatp.com/large/501000004967000a22e?123.jpg"/></p><p>图27、小马激活官方QQ群文件共享展示图</p><p><img src="http://p3.pstatp.com/large/486000a3a340c9e518c?123.jpg"/></p><p>图28、群成员展示图</p><p> 在下载时，我们发现文件刚刚落地就被火绒的下载扫描报毒（图29）。经过我们进一步分析，其样本正是我们在概述中所提到的“小马激活”病毒的第四类变种。这些证据指明，原“小马激活工具”的制作团队可能与该病毒运作团队之间存在着直接关系。</p><p><img src="http://p1.pstatp.com/large/486000a3a33885c3d67?123.jpg"/></p><p>图29、火绒下载扫描效果图</p><p> 我们通过上述所有跟踪分析，推断了该“病毒推广公司”的运作体系和业务结构。如下图所示：</p><p><img src="http://p2.pstatp.com/large/483000a460ef47dd256?123.jpg"/></p><p>图30、“病毒推广公司”的运作体系和业务结构图</p><p> 该“病毒推广公司”涉及到“白、灰、黑”三个领域的业务。</p><ul class=" list-paddingleft-2"><li><p>“白”：软件推广业务，主要通过吸引用户流量到其推广页面的方式帮助大型互联网企业进行广告推广，已知推广对象包括QQ浏览器和2345浏览器等；</p></li><li><p>“灰” ：互联网行业内的灰色地带，包括“U盘极速启动”和“小马激活工具”。由于国内互联网大环境对于版权的审查力度并不是十分严格，使得该类产品在市场中盛行，用户对该类产品也产生了依赖性；</p></li><li><p>“黑” ：与病毒相关的“黑色产业”，该公司制作“小马激活”病毒进行流量劫持，利用用户对盗版系统激活这一刚需，借助搜索引擎优化及早期“口碑营销”，在互联网中大范围传播；</p></li></ul><p>四、综述</p><p> 随着国内互联网企业之间的竞争进入白热化，产品推广作为最接近市场的最后环节成为各大软件厂商用来竞争的众矢之的。国内的各个互联网公司不惜一切代价地向市场推广自己的软件产品，由于受到利益驱使软件推广商在推广力度上不断加大，最终跨过网络安全的红线，制作病毒推广工具进行广告推广。作为收益方，被推广的互联网企业也并没有在发现这一现象后及时制止，而是继续为这些“病毒推广厂商”所提供的服务买单，促使了整个黑色产业链条的形成。</p><p> 对于“小马激活”病毒，在国内安全厂商开始对其进行全面查杀时，其贼喊抓贼、监守自盗，使很多用户甚至安全厂商都蒙在鼓里。其利用用户的长期信任与用户对于系统激活工具的麻痹大意，使得该病毒在短时间之内大范围传播。其使用十分恶劣的手段进行广告推广，严重影响了用户对计算机的正常使用，甚至对互联网行业的发展造成了不良影响。放眼中国互联网市场，“小马激活”病毒也只是 “病毒推广”黑色产业链中的一个缩影，类似于“小马激活”病毒制作团体的“病毒推广厂商”还有很多。究其本质，监管力度不足和被推广的互联网企业对于推广手段的放任、不作为才是造成“病毒推广厂商”肆意妄为的主要原因。<span> </span></p></div>
	<div class="article-actions">
		<div class="top-actions clearfix">
			
			<ul class="tag-list">
				<a href="/e/tags/?tagname=%BF%C6%BC%BC" target="_blank">科技</a> <a href="/e/tags/?tagname=%CD%F8%C2%E7%B0%B2%C8%AB" target="_blank">网络安全</a> <a href="/e/tags/?tagname=%C8%ED%BC%FE" target="_blank">软件</a> <a href="/e/tags/?tagname=%E4%AF%C0%C0%C6%F7" target="_blank">浏览器</a>				
			</ul>
			
			<a class="areport feedbtn" href="javascript:;">投诉</a>
		</div>
		<div class="bottom-actions clearfix" data-node="articleAction" data-groupid="6271897696975126786" >
			<div class="snsbox">
            	<div class="snsbox-inner">
		            <span>分享到：</span>
					<div class="bdsharebuttonbox snszone">
						<a href="#" class="sns-btn sns-qzone bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a>
						<a href="#" class="sns-btn sns-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
						<a href="#" class="sns-btn sns-weixin bds_weixin" data-cmd="weixin" title="分享到微信"></a>
					</div>
					<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"小马已变坏，“小马激活”病毒分析，你在用小马激活吗？小心了 来自今日头条","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"16"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
				</div>
			</div>

			<!-- <a class="abtn abtn-fav" data-type="repin" data-node="fav" href="javascript:;">收藏</a> -->
			
		</div>
	</div>
</div>

        
        <div id="pagelet-relatednews">
	<div class="dtag">相关阅读</div>
	<ul class="relatednews" data-node="listBox">
				<li class="item clearfix" data-node="item">
			<div class="item-inner">
				<div class="lbox left">
					<a href="/news_tech/2657.html" target="_blank">
						<img class="feedimg middle-mode" src="http://p3.pstatp.com/large/4ca000008cb2293d2fe?123.jpg" onload="this.style.opacity=1;">
					</a>
				</div>
				<div class="rbox"><!--hold-->
					<div class="rbox-inner">
						<div class="title-box">
							<a ga_event="click_title_relevant" class="link title" href="/news_tech/2657.html" target="_blank" data-node="title">
								微软小娜与美团外卖达成合作，智能自动订外卖？							</a>
						</div>
						<div class="abstract">
							<a ga_event="click_abstract_relevant" class="link" href="/news_tech/2657.html" target="_blank">微软在Build2016开发者大会上宣布全新的人工智能机器人项目，微软小娜（Cortana）将作为Win10向其他移动平台扩展的新型开发桥梁，现在微软小娜已经与中国本土美团外卖达成合</a>
						</div>
						<div class="footer clearfix">
							<div class="left lfooter">
								
								<a class="lbtn source" href="/news_tech/" target="_blank">news_tech&nbsp;&sdot;</a>	
									
								<!-- <span class="lbtn comment">0评论&nbsp;&sdot;</span> -->
								<span class="lbtn time">04-20 20:13</span>
							</div>
						</div>
					</div>
				</div>
			</div>
		</li>
				<li class="item clearfix" data-node="item">
			<div class="item-inner">
				<div class="lbox left">
					<a href="/news_tech/2655.html" target="_blank">
						<img class="feedimg middle-mode" src="http://p1.pstatp.com/large/48400056470d39cf05e?123.jpg" onload="this.style.opacity=1;">
					</a>
				</div>
				<div class="rbox"><!--hold-->
					<div class="rbox-inner">
						<div class="title-box">
							<a ga_event="click_title_relevant" class="link title" href="/news_tech/2655.html" target="_blank" data-node="title">
								网站要给用户好的体验必须遵循视线金三角分布法							</a>
						</div>
						<div class="abstract">
							<a ga_event="click_abstract_relevant" class="link" href="/news_tech/2655.html" target="_blank">视线分布金三角是根据人体习惯得出来的一个词，表示用户打开搜索结果页面后， 
目光会首先放在最左上角，然后向正下方移动挨个浏览搜索结果，当看到感兴趣的页面时，横向向</a>
						</div>
						<div class="footer clearfix">
							<div class="left lfooter">
								
								<a class="lbtn source" href="/news_tech/" target="_blank">news_tech&nbsp;&sdot;</a>	
									
								<!-- <span class="lbtn comment">0评论&nbsp;&sdot;</span> -->
								<span class="lbtn time">04-20 20:13</span>
							</div>
						</div>
					</div>
				</div>
			</div>
		</li>
				<li class="item clearfix" data-node="item">
			<div class="item-inner">
				<div class="lbox left">
					<a href="/news_tech/2634.html" target="_blank">
						<img class="feedimg middle-mode" src="http://p3.pstatp.com/large/4cb00030d9bd0789555?123.jpg" onload="this.style.opacity=1;">
					</a>
				</div>
				<div class="rbox"><!--hold-->
					<div class="rbox-inner">
						<div class="title-box">
							<a ga_event="click_title_relevant" class="link title" href="/news_tech/2634.html" target="_blank" data-node="title">
								创业者友情的小船咋说翻就翻？ 心疼最后一张图...							</a>
						</div>
						<div class="abstract">
							<a ga_event="click_abstract_relevant" class="link" href="/news_tech/2634.html" target="_blank">（漫画作者：喃东尼内容改编：小桔妹）如果你有个朋友在创业，你想约他撸串/吃饭/KTV等等等...很可能是这样的（好心疼最后一张图T_T）：以上纯属YY，如有雷同，那你一定是个</a>
						</div>
						<div class="footer clearfix">
							<div class="left lfooter">
								
								<a class="lbtn source" href="/news_tech/" target="_blank">news_tech&nbsp;&sdot;</a>	
									
								<!-- <span class="lbtn comment">0评论&nbsp;&sdot;</span> -->
								<span class="lbtn time">04-20 20:13</span>
							</div>
						</div>
					</div>
				</div>
			</div>
		</li>
				<li class="item clearfix" data-node="item">
			<div class="item-inner">
				<div class="lbox left">
					<a href="/news_tech/2654.html" target="_blank">
						<img class="feedimg middle-mode" src="http://p1.pstatp.com/large/4ca0001199b304a64b5?123.jpg" onload="this.style.opacity=1;">
					</a>
				</div>
				<div class="rbox"><!--hold-->
					<div class="rbox-inner">
						<div class="title-box">
							<a ga_event="click_title_relevant" class="link title" href="/news_tech/2654.html" target="_blank" data-node="title">
								平安银行成立首个专业电商俱乐部							</a>
						</div>
						<div class="abstract">
							<a ga_event="click_abstract_relevant" class="link" href="/news_tech/2654.html" target="_blank">日前，2016世界电子商务大会在浙江义乌召开。作为我国目前规模最大的电子商务大会，本次大会云集了国内外电商行业龙头。会议期间，平安银行还发起成立了首个专业电商俱乐部</a>
						</div>
						<div class="footer clearfix">
							<div class="left lfooter">
								
								<a class="lbtn source" href="/news_tech/" target="_blank">news_tech&nbsp;&sdot;</a>	
									
								<!-- <span class="lbtn comment">0评论&nbsp;&sdot;</span> -->
								<span class="lbtn time">04-20 20:13</span>
							</div>
						</div>
					</div>
				</div>
			</div>
		</li>
			</ul>
</div>
        

        <div class="d-union-1"></div>

        

<div id="pagelet-ncomment">
	<!-- 用来实现在首页点击评论跳转至详情页评论区 -->
	<div id="comment_area"></div>
	<div class="cheader clearfix">
		<div class="dtag">文章评论 ・ <a href="/e/pl/?classid=4&id=2465" target="_blank">所有评论</a></div>
		<div class="ctotal">
			<span class="ctotalnum" data-node="ctotalnum"><script type="text/javascript" src="/e/public/ViewClick/?classid=4&id=2465&down=2"></script></span>条
		</div>
	</div>
	<form action="/e/pl/doaction.php" method="post" name="saypl" id="saypl" >
	<input name="username" type="hidden" class="inputText" id="username" value="" size="16" />
	<input name="password" type="hidden" class="inputText" id="password" value="" size="16" />
	<input name="id" type="hidden" id="id" value="2465" />
	<input name="classid" type="hidden" id="classid" value="4" />
	<input name="enews" type="hidden" id="enews" value="AddPl" />
	<input name="repid" type="hidden" id="repid" value="0" />
	<input type="hidden" name="ecmsfrom" value="/news_tech/2465.html">
	<div class="ceditzone clearfix">
		<div class="cavatar" data-node="cavatar"><img src="" onload="this.style.opacity=1" style="opacity: 1;"></div>
		<div class="cbody cedit" data-node="cedit">
			<div class="ctextarea">
				<textarea class="cinput" name="saytext" placeholder="写下你的评论..." onfocus="$(this).parent().parent().addClass('focus');$('#yzm').show()"></textarea>
			</div>
			<div class="caction">
				<div class="cshare">
					<div class="snsbox" style="font-size:13px">
						 评论请遵守当地法律法规
					</div>
				</div>
<span style="position:relative;top:5px;left:40px;display:none;" id="yzm">
				<input name="key" type="text" class="inputText" size="10"  />
				<img style="position: relative;top: 5px;" src="/e/ShowKey/?v=pl" align="absmiddle" name="plKeyImg" id="plKeyImg" onclick="plKeyImg.src='/e/ShowKey/?v=pl&t='+Math.random()" title="看不清楚,点击刷新" />
				匿名:<input name="nomember" type="checkbox" id="nomember" value="1" checked="checked" />
</span>
				<input type="submit" name="imageField" value="发表" class="csubmit" style="    border: none;">
			</div>
		</div>
	</div>
	</form>
	<ul id="clist" class="clist" data-node="listBox">
		<script>
		//登录头像
		$.get('/e/pl/more/userpic.php',{},function(ret){
			$('.cavatar img').attr('src',ret);
		})
		//评论内容
		var p=1;
		function getmorepl(){
			var plurl='/e/pl/more/more.php?classid=4&id=2465&num=5&p='+p;
			$.get(plurl,{},function(ret){
				$('#clist').append(ret);
				p=p+1;
				var re = 'digg-num';
				var len = ret.split(re).length;
				if(len<6){
					$('.cloadmore').text('全部加载完毕').attr('onclick','');
				}
			});
		}
		$(function(){getmorepl();})
		</script>
		
	</ul>
	
	<a class="cloadmore" href="javascript:;" style="display:block;text-align:center;" onclick="getmorepl()">点击加载更多</a>
</div>

      </div>
      <div class="detail-right">
                <div id="pagelet-nsubscribe" class="sideGap">
      <div class="Pgc_info">
        <div class="image_head" style="background:url(/style/admin.jpg) no-repeat;background-size:100% 100%;">
          
          <img onload="this.style.opacity=1" src="111111" alt="" />

        </div>

        <span class="Pgc_name">
          admin 
        </span>
        <span class="Pgc_details"></span>

        
        
        <!-- <a data-action="like" class="Pgc_btn" data-node="Pgc_subscribe"  data-mediaid="">
          关注本文作者
        </a> -->
        
        

      </div>

<div class="article_container">
      <div class="Pgc_article">
        <ul>
                    <li >
              <a target="_blank" href="/news_hot/2667.html">绿营集体沉默噤若寒蝉 网民:只会出</a>
          </li>
                    <li >
              <a target="_blank" href="/gonggao/2662.html">今日头条上线</a>
          </li>
                    <li >
              <a target="_blank" href="/news_tech/2657.html">微软小娜与美团外卖达成合作，智能</a>
          </li>
                    <li >
              <a target="_blank" href="/news_tech/2656.html">京盾华鼎：将整合线下资源打造O2O跨</a>
          </li>
                    <li >
              <a target="_blank" href="/news_tech/2655.html">网站要给用户好的体验必须遵循视线</a>
          </li>
          
        </ul>
      </div>
      </div>
</div>

        

        <div id="pagelet-iad" class="sideGap">
			<script src=/d/js/acmsd/thea2.js></script>
		</div>
        
		<div id="pagelet-hotvideo" class="sideGap">
			<div class="hotvideo_head dtag">本月点击排行</div>
			<ul class="monthhot">
							</ul>
		</div>
		
        <div id="pagelet-hotgallery" class="sideGap">
			<div class="dtag">精彩图片</div>
			<ul class="hotgallery_show">
							</ul>
		</div>
        

      </div>
    </div>
    <div id="pagelet-sidetool">
		<div class="sidetool-innner">
		<a class="stool rhome" href="/" target="_self" ga_event="click_homepage_interactive"></a>
		<a class="stool rcomment" href="javascript:;" onclick="$('html,body').animate({scrollTop:$('#comment_area').offset().top-30}, 800);">
			<span class="sidetxttip">文章评论</span>
		</a>
		
		<a class="stool rarticle" href="javascript:;" onclick="$('html,body').animate({scrollTop:$('#pagelet-relatednews').offset().top-90}, 800);">
			<span class="sidetxttip">相关阅读</span>
		</a>
		
		<span class="stool rshare" href="javascript:;" data-node="rshare">
			<div class="sidesnstip">
				<div class="snsbox">
					<div class="snsbox-inner">
			            <span style="line-height: 40px;">分享到：</span>
			            <div class="bdsharebuttonbox snszone">
							<a href="#" class="sns-btn sns-qzone bds_qzone" data-cmd="qzone" title="分享到QQ空间" style="margin-left:5px"></a>
							<a href="#" class="sns-btn sns-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博" style="margin-left:5px"></a>
							<a href="#" class="sns-btn sns-weixin bds_weixin" data-cmd="weixin" title="分享到微信" style="margin-left:5px"></a>
						</div>
					</div>
				</div>
			</div>
		</span>
		
		<a class="stool rtop" href="javascript:;" onclick="$('html,body').animate({scrollTop: '0px'}, 800);"></a>
	</div>
</div>

  </div>


   <div id="aboutus">
        <div>
            <span class="fitem">&#169; 2016 今日头条 http://ceshi.codes99.com/</span>
            
            <a class="fitem" href="http://www.12377.cn/" target="_blank">中国互联网举报中心</a>
            
            <a class="fitem" href="http://www.miibeian.gov.cn/" target="_blank">京ICP证140141号</a>
            <a class="fitem" href="http://www.miibeian.gov.cn/" target="_blank">
			京公网安备 11010802020116号</a>
            
        </div>
        <div>
            <span class="fitem">违法和不良信息举报：xxx@xxx.com</span>
            <span style="display:none">统计代码填到这里 </span>
            
            
        </div>
    </div>
    
 <script src="/e/extend/DoTimeRepage/"></script>
    <script src="/e/public/ViewClick/?classid=4&id=2465&addclick=1"></script>
</body>
</html>
